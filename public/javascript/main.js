var audioObject=new Audio;let play=!1,playingSong=null;var geocoder,map,marker;$("body").on("click",".album",function(e){if(!play&&(audioObject.pause(),playingSong==$(this).data("album-id")))return;playingSong=$(this).data("album-id");let t=$(this).data("album-id"),a=$(this).data("artist-name"),s=($(this).data(""),this),o={album:t,artist:a};$.post("/tracks",o,(e,t,a)=>{for(let t=0;t<e.data.length;t++)if(null!==e.data[t].preview_url)return audioObject.pause(),void(audioObject=new Audio(e.data[t].preview_url)).play();play=!1,new $.peekABar({html:"Oh no! There's no Music!!!!!",backgroundColor:"red",autohide:!0}).show(),$(s).find("button").remove(),window.t=s})}),$(".results").on("click",".js-play-toggle",()=>{play=!play}),$(()=>{const e=[];$("form").submit(t=>{t.preventDefault(),codeAddress();const a=$(".searchBox").val().toUpperCase();let s=$(".searchBox").val().toLowerCase(),o="",n="";$(".searchBox").val(""),n+=`<h2>Top Artists for <span class="capitalize">${s}</span></h2>`,$("#countryRender").html(n),e.push(a);for(let t=0;t<e.length;t++)o+=`<div class="js-recentCountry recentCountry">${e[t]}</div>`;$("#previouslySearched").html(o)}),$("#previouslySearched").on("click",".js-recentCountry",function(){codeAddress($(this).text()).toUpperCase()})}),$(document).ready(function(){$(".results").on("click",".button",function(){$(this).toggleClass("paused")})});var codeAddress=(e="Spain")=>{geocoder=new google.maps.Geocoder;let t=document.getElementById("city_country").value||e;geocoder.geocode({address:t},(e,t)=>{t==google.maps.GeocoderStatus.OK?((map=new google.maps.Map(document.getElementById("mapCanvas"),{zoom:6,streetViewControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,mapTypeIds:[google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.ROADMAP]},center:e[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP})).setCenter(e[0].geometry.location),marker=new google.maps.Marker({map:map,position:e[0].geometry.location,draggable:!0,title:"My Title"}),updateMarkerPosition(e[0].geometry.location),geocodePosition(e[0].geometry.location),google.maps.event.addListener(marker,"dragstart",()=>{updateMarkerAddress("Dragging...")}),google.maps.event.addListener(marker,"drag",()=>{updateMarkerStatus("Dragging..."),updateMarkerPosition(marker.getPosition())}),google.maps.event.addListener(marker,"dragend",()=>{updateMarkerStatus("Drag ended"),geocodePosition(marker.getPosition()),map.panTo(marker.getPosition())}),google.maps.event.addListener(map,"click",e=>{$("form").submit(),updateMarkerPosition(e.latLng),marker.setPosition(e.latLng),geocodePosition(marker.getPosition()),map.panTo(marker.getPosition())})):alert("Geocode was not successful for the following reason: "+t)})};function geocodePosition(e){geocoder.geocode({latLng:e},e=>{if(e&&e.length>0)for(let t=0;t<e[0].address_components.length;t+=1){let a=e[0].address_components[t];for(let e=0;e<a.types.length;e+=1)"country"===a.types[e]&&updateMarkerAddress(a.short_name)}else updateMarkerAddress("Cannot determine address at this location.")})}function updateMarkerStatus(e){document.getElementById("markerStatus").innerHTML=e}function updateMarkerPosition(e){document.getElementById("info").innerHTML=[e.lat(),e.lng()].join(", ")}function updateMarkerAddress(e){$.post("/location",{countryCode:e},t=>{document.getElementById("address").innerHTML=e,loopThroughPlaylist(t.featurePlaylist.albums.items)})}function loopThroughPlaylist(e){let t="";for(let a=0;a<e.length;a++)t+=`<div class="song-detail">\n        <img src="${e[a].images[0].url}" alt="Album Artwork" class="albumArt"></img><br>\n        <span class="bold">Artist:</span> ${e[a].artists[0].name}<br>\n        <span class="bold">Top Album:</span> ${e[a].name} <br>\n        <div data-artist-name='${e[a].artists[0].name}' data-album-id='${e[a].id}' class='album js-play-toggle'><button class="play-toggle button"></button></div>\n      </div>`;$(".results").html(t)}$(e=>{"use strict";e.peekABar=function(t){var a=this,s=parseInt(1e8*Math.random(),0);this.bar={},this.settings={};var o={delay:3e3,padding:"1em",animation:{type:"slide",duration:"slow"},cssClass:null,opacity:".8",position:"top",onShow:()=>{},onHide:()=>{},closeOnClick:!1};this.show=(e=>{switch(void 0!==e&&e.html&&this.bar.html(e.html),this.settings.animation.type){case"slide":this.bar.slideDown(a.settings.animation.duration);break;case"fade":this.bar.fadeIn(a.settings.animation.duration)}this.settings.autohide&&setTimeout(function(){a.hide()},this.settings.delay),this.settings.onShow.call(this,e)}),this.hide=(()=>{switch(this.settings.animation.type){case"slide":this.bar.slideUp(a.settings.animation.duration);break;case"fade":this.bar.fadeOut(a.settings.animation.duration)}this.settings.onHide.call(this)});var n=()=>{a.bar=e("<div></div>").addClass("peek-a-bar").attr("id","__peek_a_bar_"+s),e("html").append(a.bar),a.bar.hide()},i=()=>{r(),d(),l(),g(),p(),c(),u()},r=()=>{a.bar.html(a.settings.html)},d=()=>{a.settings.autohide&&setTimeout(()=>{a.hide()},a.settings.delay)},l=()=>{a.bar.css("padding",a.settings.padding)},g=()=>{a.bar.css("background-color",a.settings.backgroundColor)},c=()=>{null!==a.settings.cssClass&&a.bar.addClass(a.settings.cssClass)},p=()=>{a.bar.css("opacity",a.settings.opacity)},u=()=>{switch(a.settings.position){case"top":a.bar.css("top",0);break;case"bottom":a.bar.css("bottom",0);break;default:a.bar.css("top",0)}};return a.settings=e.extend({},o,t),n(),i(),this}})(jQuery);